Project Status Summary: Font, Language & Hot Swap
1. Core Logic:

Centralized Storage: Using storage.js with LS_KEYS.LANG and getStoredLang().

State Sync: syncAppState() (in theme.js) is the "Single Source of Truth." It updates document.documentElement.lang, dir, and the Font based on localStorage.

Router Integration: routerClass.js is now async. It awaits the page handler (content render) before calling syncAppState() to prevent the "English Flash" and ensure fonts apply to existing DOM elements.

2. UI & Navigation:

Toolbar: Uses a "Hot Swap" strategy. When the language changes, it:

Updates localStorage.

Updates the URL path (e.g., /en/ to /th/) using window.history.pushState.

Triggers router.resolve() and a setTimeout based renderToolbar() to refresh the UI without a full page reload.

Hidden Selects: Positioned absolute within a relative toolbar with opacity: 0.01 and 1px size to satisfy browser .showPicker() visibility requirements.

3. Pending UX Task:

Interruption Logic: Need to implement listeners for wheel, touchmove, and keydown to stop the speechManager singleton and clear the speechController auto-scroll/sentence timeouts when the user interacts manually.

Analyse the Uploaded updated ZIP and "Implement the Manual Scroll Interruption logic in speechController.js based on the provided summary."


============================

The Context: "I am starting a major refactor/redesign of my language learning app's data model. We are starting with a clean slate. The app is currently stable and working correctly after a successful Git restoration.

The Goal: [Insert: e.g., 'I want to move from local JSON files to a more dynamic structure' OR 'I want to simplify how exercises are linked to books.']

The Technical Foundation (Current Working Files): To ensure we don't repeat past mistakes, here is the current 'Source of Truth' for the core architecture. Please analyze these for dependencies before we begin the refactor:

bootstrap.js: (Paste code)

locales.js: (Paste code)

router.js: (Paste code)

app.css (The Global Variables only): (Paste the :root and layout sections)

Constraint: Do not suggest any changes yet. Confirm you understand how these files currently interact with the Google Drive data structure."

One Last Tip for your Rethink
During your break, if you are looking at the data model, try to sketch it out on paper. Often, "Icon/Slider" bugs happen because the UI is trying to render data that hasn't finished loading yet.